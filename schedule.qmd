---
title: "AD 6698 Generative AI for Business Analytics" 
subtitle: "Schedule"
number-sections: true
format:
    html:
      toc: false
html-table-processing: none
---

## Course Schedule

Please adhere to the due dates posted on the course website. [Late work is not accepted]{.bloodred-bold}.

```{python}
#| echo: false
#| output: markdown

from datetime import datetime, timedelta
import pandas as pd
from IPython.display import display, Markdown

# Function to generate the Day 1 - Day 7 list based on a start date
def generate_days(start_date):
    days = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"]
    start_day_index = days.index(start_date)
    days_shifted = days[start_day_index:] + days[:start_day_index]
    return days_shifted

# Start dates for each section
start_dates = {
    "A1": "Tuesday",
    "A2": "Thursday",
    "A3": "Wednesday"
}

# Initialize the combined table data
combined_data = {"Day": [f"Day {i+1}" for i in range(7)]}

# Generate and add columns for each section
for section, start_date in start_dates.items():
    combined_data[section] = generate_days(start_date)

# Create a single DataFrame
combined_table = pd.DataFrame(combined_data)

# Display the combined table without index
display(combined_table.style.hide(axis="index"))

```


### Course Schedule

```{python}
# | label: build-course-schedule
# | echo: false
# | warning: false
# | message: false
# | output: html

import pandas as pd
from IPython.display import display, HTML
from schedules.build_schedule import build
from schedules.online_schedule import generate as generate_online
import sys

# -------------------------------------------------
# Clear module cache (important for Quarto reruns)
# -------------------------------------------------
for m in list(sys.modules):
    if m.startswith(("schedules", "bu_calendar")):
        del sys.modules[m]

# -------------------------------------------------
# SECTION CONFIGURATION (single source of truth)
# -------------------------------------------------
sections = {
    "A1": {
        "mode": "oncampus",
        "class_days": [0],   # Mon
    },
    "O": {
        "mode": "online",
        "start_date": "2026-03-12",
        "class_days": [3],      # Thu
    }
}

# -------------------------------------------------
# Load COURSE DESCRIPTION (content only)
# -------------------------------------------------
course_table = (
    pd.read_excel(
        "data/AD698-Schedule.xlsx",
        sheet_name="Course Details"
    )
    .drop(columns=["Modules"], errors="ignore")
)

# Keep lecture rows only (drop footer/admin rows)
course_table = course_table.iloc[:-4].reset_index(drop=True)

course_table = course_table[["Lecture", "Title"]]
n_lectures = len(course_table)

# -------------------------------------------------
# Generate schedules PER SECTION
# -------------------------------------------------
section_dates = {}

for section, meta in sections.items():
    if meta["mode"] == "oncampus":
        _, dates = build(
            return_dates=True,
            class_days=meta["class_days"]
        )
    else:  # online
        _, dates = generate_online(
            start_date=meta["start_date"],
            lecture_count=n_lectures,
            class_days=meta["class_days"]
        )

    # Safety check
    assert len(dates) == n_lectures, (
        f"{section}: expected {n_lectures} dates, got {len(dates)}"
    )

    section_dates[section] = dates

# -------------------------------------------------
# Attach section columns (ONLINE LAST)
# -------------------------------------------------
oncampus_sections = [
    s for s in sections if sections[s]["mode"] == "oncampus"
]
online_sections = [
    s for s in sections if sections[s]["mode"] == "online"
]

# On-campus first
for s in oncampus_sections:
    course_table[s] = section_dates[s]

# Online last (single column O)
for s in online_sections:
    course_table[s] = section_dates[s]

# -------------------------------------------------
# Date formatting
# -------------------------------------------------


def fmt(d):
    return "-" if pd.isna(d) else d.strftime("%d-%b")


for col in course_table.columns[2:]:
    course_table[col] = course_table[col].map(fmt)

# -------------------------------------------------
# Presentation
# -------------------------------------------------
styled = (
    course_table
    .style
    .hide(axis="index")
    .set_table_styles([
        {"selector": "th", "props": [("text-align", "left")]},
        {"selector": "td", "props": [
            ("text-align", "left"),
            ("vertical-align", "top"),
            ("white-space", "nowrap")
        ]},
    ])
)

display(HTML(styled.to_html()))

```
