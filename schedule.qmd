---
title: "AD 6698 Generative AI for Business Analytics" 
subtitle: "Schedule"
number-sections: true
format:
    html:
      toc: false
html-table-processing: none
---

## Course Schedule

Please adhere to the due dates posted on the course website. [Late work is not accepted]{.bloodred-bold}.

```{python}
#| echo: false
#| output: markdown

from datetime import datetime, timedelta
import pandas as pd
from IPython.display import display, Markdown

# Function to generate the Day 1 - Day 7 list based on a start date
def generate_days(start_date):
    days = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"]
    start_day_index = days.index(start_date)
    days_shifted = days[start_day_index:] + days[:start_day_index]
    return days_shifted

# Start dates for each section
start_dates = {
    "A1": "Tuesday",
    "A2": "Thursday",
    "A3": "Wednesday"
}

# Initialize the combined table data
combined_data = {"Day": [f"Day {i+1}" for i in range(7)]}

# Generate and add columns for each section
for section, start_date in start_dates.items():
    combined_data[section] = generate_days(start_date)

# Create a single DataFrame
combined_table = pd.DataFrame(combined_data)

# Display the combined table without index
display(combined_table.style.hide(axis="index"))

```


### Course Schedule

```{python}
# | echo: false
# | output: html

import pandas as pd
from IPython.display import display, HTML
from schedules.build_schedule import build
from schedules.precourse import apply_precourse_modules
import sys

# -------------------------------------------------
# Clear module cache (important for Quarto)
# -------------------------------------------------
for m in list(sys.modules):
    if m.startswith(("schedules", "bu_calendar")):
        del sys.modules[m]

# -------------------------------------------------
# Load course table
# -------------------------------------------------
course_schedule = (
    pd.read_excel(
        "data/AD698-Schedule.xlsx",
        sheet_name="Course Details"
    )
    .drop("Modules", axis=1)
)
# remove last two rows
course_schedule.drop(course_schedule.index[-2:], inplace=True)

n_rows = len(course_schedule)

# L0.x rows are always first two
precourse_rows = 2
lecture_rows = n_rows - precourse_rows

# -------------------------------------------------
# Generate ON-CAMPUS dates (L1â€“L13 only)
# -------------------------------------------------
oncampus_df, oncampus_dates = build(
    return_dates=True,
    class_days=[3]   # Thursday
)

# ðŸ”’ Engine contract
assert len(oncampus_dates) == 14, (
    f"Engine returned {len(oncampus_dates)} dates; expected 14 (L1-L14)."
)

# ðŸ”’ Table contract
assert lecture_rows == 14, (
    f"Expected 14 lecture rows (L1.1-L7.2), found {lecture_rows}."
)

semester_start = oncampus_dates[0]

# -------------------------------------------------
# Online schedule (7 weeks â†’ paired into 14 lectures)
# -------------------------------------------------
online_start = pd.to_datetime("2026-03-12")

online_weekly = [
    online_start + pd.Timedelta(weeks=i)
    for i in range(7)
]

online_lecture_dates = []
for d in online_weekly:
    online_lecture_dates.extend([d, d])

assert len(online_lecture_dates) == lecture_rows

# -------------------------------------------------
# Reset date columns FIRST
# -------------------------------------------------
course_schedule["Online"] = pd.NaT
course_schedule["On-Campus"] = pd.NaT

# -------------------------------------------------
# Apply precourse modules (L0.1, L0.2 ONLY)
# -------------------------------------------------
course_schedule = apply_precourse_modules(
    course_schedule,
    semester_start=semester_start
)

# -------------------------------------------------
# Assign lecture dates (positional, safe)
# -------------------------------------------------

# On-campus: 14 dates â†’ first 14 lecture rows
course_schedule.iloc[
    precourse_rows: precourse_rows + len(oncampus_dates),
    course_schedule.columns.get_loc("On-Campus")
] = oncampus_dates

# Online: 14 paired dates â†’ all lecture rows
course_schedule.iloc[
    precourse_rows: precourse_rows + lecture_rows,
    course_schedule.columns.get_loc("Online")
] = online_lecture_dates

# -------------------------------------------------
# Formatting & display
# -------------------------------------------------
date_cols = ["Online", "On-Campus"]


def date_formatter(x):
    return "-" if pd.isna(x) else x.strftime("%d-%b")


def restrict_width(_):
    return [
        ("max-width", "275px"),
        ("overflow", "hidden"),
        ("text-overflow", "ellipsis")
    ]

# drop online and On-campus columns


# course_schedule.drop(["Online", "On-Campus"], axis=1, inplace=True)


styled_table = (
    course_schedule
    .style
    .hide(axis="index")
    .format({col: date_formatter for col in date_cols})
    .set_table_styles([
        {"selector": "th", "props": [("text-align", "left")]},
        {"selector": "td", "props": [("text-align", "left")]},
        # {"selector": "tbody td:nth-child(2)", "props": restrict_width(None)},
        # {"selector": "tbody td:nth-child(3)", "props": restrict_width(None)}
    ])
)

display(HTML(styled_table.to_html()))

```
